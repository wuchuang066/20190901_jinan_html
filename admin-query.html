<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>XXXX å•†åŸåå°ç®¡ç†ç³»ç»Ÿ</title>
    <!-- å¯¼å…¥å›¾æ ‡ -->
    <link href="img/favicon1.ico" rel="icon">
    <!-- Vendor styles -->
    <link rel="stylesheet"
          href="vendors/bower_components/material-design-iconic-font/dist/css/material-design-iconic-font.min.css">
    <link rel="stylesheet" href="vendors/bower_components/animate.css/animate.min.css">
    <link rel="stylesheet" href="vendors/bower_components/jquery.scrollbar/jquery.scrollbar.css">
    <link rel="stylesheet" href="vendors/bower_components/fullcalendar/dist/fullcalendar.min.css">
    <link rel="stylesheet" href="vendors/bower_components/select2/dist/css/select2.min.css">

    <!-- App styles -->
    <link rel="stylesheet" href="css/app.min.css">
</head>

<body data-sa-theme="1">
<main class="main">
    <div class="page-loader">
        <div class="page-loader__spinner">
            <svg viewBox="25 25 50 50">
                <circle cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/>
            </svg>
        </div>
    </div>
    <!-- é¡µé¢é¡¶éƒ¨å¼€å§‹ -->
    <header class="header">

    </header>
    <!-- é¡µé¢é¡¶éƒ¨ç»“æŸ -->
    <!-- é¡µé¢å·¦ä¾§ä»£ç  start -->
    <aside class="sidebar">

    </aside>
    <!-- é¡µé¢å·¦ä¾§ end -->
    <!-- å³ä¾§å†…å®¹å¼€å§‹ -->
    <section class="content">
        <nav aria-label="breadcrumb" role="navigation">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">ç®¡ç†å‘˜ä¿¡æ¯</a></li>
                <li class="breadcrumb-item active" aria-current="page">æŸ¥è¯¢ç®¡ç†å‘˜</li>
            </ol>
        </nav>
        <div class="card">
            <div class="card-body">
                <!-- æŸ¥è¯¢æ¡ä»¶å¼€å§‹ -->
                <div class="row">
                    <div class="col-lg-3">
                        <input id="admin-name" type="text" class="form-control" placeholder="è¯·è¾“å…¥è¦æŸ¥è¯¢çš„ç®¡ç†å‘˜å§“å...">
                    </div>
                    <div class="col-lg-3">
                        <select class="select2" id="admin-power">
                            <option value="-1">ä¸é™</option>
                            <option value="1">è¶…çº§ç®¡ç†å‘˜</option>
                            <option value="2">æ™®é€šç®¡ç†å‘˜</option>
                        </select>
                    </div>
                    <div class="col-lg-3">
                        <button class="btn btn-light btn--icon-text" id="select-btn"><i class="zmdi zmdi-search"></i>
                            Search
                        </button>
                    </div>
                </div>
                <!-- æŸ¥è¯¢æ¡ä»¶ç»“æŸ -->
                <br>
                <table class="table table-striped table-hover">
                    <thead>
                    <tr>
                        <th>åºå·</th>
                        <th>ç®¡ç†å‘˜ç¼–å·</th>
                        <th>ç®¡ç†å‘˜å§“å</th>
                        <th>ç®¡ç†å‘˜ç”µè¯</th>
                        <th>ç®¡ç†å‘˜é‚®ç®±</th>
                        <th>ç®¡ç†å‘˜æƒé™</th>
                        <th>çŠ¶æ€</th>
                    </tr>
                    </thead>
                    <tbody id="adminTbody">
                    <!-- 	<tr>
                        <td>1</td>
                        <td>01</td>
                        <td><a href="#" data-toggle="modal" data-target="#updateAdminMessage">å¼ ä¸‰</a></td>
                        <td>13800000000</td>
                        <td>2734637@qq.com</td>
                        <td>æ™®é€šç®¡ç†å‘˜</td>
                        <td>
                            <div class="toggle-switch">
                                <input type="checkbox" class="toggle-switch__checkbox">
                                <i class="toggle-switch__helper"></i>
                            </div>
                        </td>
                    </tr> -->
                    <!-- <tr>
                        <td>1</td>
                        <td>01</td>
                        <td>å¼ ä¸‰</td>
                        <td>13800000000</td>
                        <td>2734637@qq.com</td>
                        <td>æ™®é€šç®¡ç†å‘˜</td>
                        <td>
                            <div class="toggle-switch">
                                <input type="checkbox" class="toggle-switch__checkbox asdf" checked="">
                                <i class="toggle-switch__helper"></i>
                            </div>
                        </td>
                    </tr> -->
                    </tbody>

                </table>
                <nav>
                    <ul class="pagination justify-content-center" id="adminPageBtns">
                        <!-- <li class="page-item pagination-prev"><a class="page-link" href="#"></a></li>
                        <li class="page-item"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item"><a class="page-link" href="#">4</a></li>
                        <li class="page-item"><a class="page-link" href="#">5</a></li>
                        <li class="page-item"><a class="page-link" href="#">6</a></li>
                        <li class="page-item pagination-next"><a class="page-link" href="#"></a></li> -->
                    </ul>
                </nav>
            </div>
        </div>
    </section>
    <!-- å³ä¾§å†…å®¹ç»“æŸ -->

</main>
<!-- æ¨¡æ€æ¡† start -->
<div class="modal fade" id="updateAdminMessage" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <!-- æ¨¡æ€æ¡†é¡¶éƒ¨ -->
            <div class="modal-header">
                <h5 class="modal-title pull-left">Admin Message</h5>
            </div>
            <!-- æ¨¡æ€æ¡†ä¸­é—´éƒ¨åˆ† -->
            <div class="modal-body">
                <!-- æ·»åŠ éšè—è¡¨å•åŸŸ ä¿å­˜ç®¡ç†å‘˜ç¼–å· å’Œé¡µç -->
                <input type="hidden" id="updateAdminId">
                <input type="hidden" id="adminPage" value="1">
                <div class="row">
                    <div class="col-lg-3 text-center" style="padding-top: 8px;">ç®¡ç†å‘˜å§“å:</div>
                    <div class="col-lg-9"><input type="text" class="form-control" id="updateAdminName"></div>
                </div>
                <div class="row" style="margin-top:10px">
                    <div class="col-lg-3 text-center" style="padding-top: 8px;">ç®¡ç†å‘˜ç”µè¯:</div>
                    <div class="col-lg-9"><input type="text" class="form-control" id="updateAdminPhone"></div>
                </div>
                <div class="row" style="margin-top:10px">
                    <div class="col-lg-3 text-center" style="padding-top: 8px;">ç®¡ç†å‘˜é‚®ç®±:</div>
                    <div class="col-lg-9"><input type="text" class="form-control" id="updateAdminEmail"></div>
                </div>

            </div>

            <!-- æ¨¡æ€æ¡†åº•éƒ¨ -->
            <div class="modal-footer">
                <button type="button" class="btn btn-link" id="updateAdminMsg">ä¿®æ”¹</button>
                <button type="button" class="btn btn-link" data-dismiss="modal">å…³é—­</button>
            </div>
        </div>
    </div>
</div>
<!-- æ¨¡æ€æ¡† end -->

<!-- Javascript -->
<!-- æ¼‚äº®å¼¹æ¡† å¼€å§‹ -->
<script src="js/sweetalert.min.js"></script>
<!-- æ¼‚äº®å¼¹æ¡† ç»“æŸ -->
<!-- Vendors -->
<script src="js/jquery-1.10.2.js"></script>
<script src="vendors/bower_components/popper.js/dist/umd/popper.min.js"></script>
<script src="vendors/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="vendors/bower_components/jquery.scrollbar/jquery.scrollbar.min.js"></script>
<script src="vendors/bower_components/jquery-scrollLock/jquery-scrollLock.min.js"></script>

<script src="vendors/bower_components/salvattore/dist/salvattore.min.js"></script>
<script src="vendors/bower_components/flot/jquery.flot.js"></script>
<script src="vendors/bower_components/flot/jquery.flot.resize.js"></script>
<script src="vendors/bower_components/flot.curvedlines/curvedLines.js"></script>
<script src="vendors/bower_components/jqvmap/dist/jquery.vmap.min.js"></script>
<script src="vendors/bower_components/jqvmap/dist/maps/jquery.vmap.world.js"></script>
<script src="vendors/bower_components/jquery.easy-pie-chart/dist/jquery.easypiechart.min.js"></script>
<script src="vendors/bower_components/peity/jquery.peity.min.js"></script>
<script src="vendors/bower_components/moment/min/moment.min.js"></script>
<script src="vendors/bower_components/fullcalendar/dist/fullcalendar.min.js"></script>
<script src="vendors/bower_components/select2/dist/js/select2.full.min.js"></script>

<!-- Charts and maps-->
<script src="demo/js/flot-charts/curved-line.js"></script>
<script src="demo/js/flot-charts/line.js"></script>
<!-- <script src="demo/js/flot-charts/dynamic.js"></script> -->
<script src="demo/js/flot-charts/chart-tooltips.js"></script>
<script src="demo/js/other-charts.js"></script>
<script src="demo/js/jqvmap.js"></script>
<script src="js/url.js"></script>
<!-- App functions and actions -->
<script src="js/app.min.js"></script>

<!-- è‡ªå·±å†™çš„jsä»£ç  -->
<script type="text/javascript">
    // å½“é¡µé¢åŠ è½½å®Œæ¯•ä¹‹åï¼Œè‡ªåŠ¨è§¦å‘æŸ¥è¯¢äº‹ä»¶
    window.onload = function () {
        $('#select-btn').trigger("click");
    }
    // åŠ è½½é¡µé¢å¤´éƒ¨å†…å®¹
    $(".header").load("head.html");
    // è®¾ç½®æ¿€æ´»èœå•
    window.sessionStorage.removeItem("menu");
    window.sessionStorage.removeItem("sub-menu");
    window.sessionStorage.setItem("menu", "admin-menu");
    window.sessionStorage.setItem("sub-menu", "admin-menu-query");
    // åŠ è½½é¡µé¢å·¦ä¾§å†…å®¹
    $(".sidebar").load("left.html");

    $(function () {

        /* æŸ¥è¯¢æŒ‰é’®çš„å•å‡»äº‹ä»¶ */
        $("#select-btn").click(function () {
            //æŸ¥è¯¢ç¬¬ä¸€é¡µç®¡ç†å‘˜çš„ä¿¡æ¯
            selectAdminPages(1);
        });

        /* æŸ¥è¯¢æŒ‡å®šé¡µæ•°çš„ç®¡ç†å‘˜ä¿¡æ¯ */
        function selectAdminPages(pageNumber) {
            $("#adminPage").val(pageNumber);
            // æŸ¥æ‰¾trå¹¶ç§»é™¤
            var tbody = $("#adminTbody");
            tbody.find("tr").remove();
            // é¡µæ•°å¤§äº1 æ˜¾ç¤ºåˆ†é¡µæŒ‰é’®
            const pageBtnUl = $("#adminPageBtns");
            // ç§»é™¤æ‰€æœ‰çš„li
            pageBtnUl.find("li").remove();
            // åˆ›å»ºurl
            var url = urlArray[5] + pageNumber;
            var adminName = $("#admin-name").val();
            var adminPower = $("#admin-power").val();
            var data = {
                adminName,
                adminPower
            };
            $.post(url, data, function (result) {
                if (result.code == 0) {
                    var list = result.resultData.adminsPage.list;
                    // è·å¾—åºå·
                    var rowNumber = result.resultData.adminsPage.startRow;
                    for (var i = 0; i < list.length; i++) {
                        var admin = list[i];
                        var tr = $("<tr></tr>");
                        tr.append($("<td>" + (rowNumber + i) + "</td>"));
                        tr.append($("<td>" + admin.adminId + "</td>"));
                        tr.append($(
                            `<td><a class="showAdminModel" href=${admin.adminId} data-toggle="modal" data-target="#updateAdminMessage">${admin.adminName}</a></td>`
                        ));
                        tr.append($("<td>" + admin.adminPhone + "</td>"));
                        tr.append($("<td>" + admin.adminEmail + "</td>"));
                        tr.append($("<td>" + (admin.adminPower == 1 ? "è¶…çº§ç®¡ç†å‘˜" : "æ™®é€šç®¡ç†å‘˜") + "</td>"));

                        const adminSessionId = JSON.parse(window.sessionStorage.getItem("loginAdmin")).adminId;
                        const adminSessionPower = JSON.parse(window.sessionStorage.getItem("loginAdmin")).adminPower;
                        // å¦‚æœå½“å‰ç™»é™†çš„æ˜¯è¶…çº§ç®¡ç†å‘˜
                        if (adminSessionPower == 1) {
                            // ä¸èƒ½å°†è‡ªå·±çš„çŠ¶æ€ä¿®æ”¹ä¸ºç¦ç”¨çŠ¶æ€ å…¶ä½™éƒ½èƒ½æ”¹
                            if (admin.adminId == adminSessionId) {
                                tr.append($(
                                    `<td><div class="toggle-switch"><input type="checkbox" href="${admin.adminId}" class="toggle-switch__checkbox" checked disabled><i class="toggle-switch__helper"></i></div></td>`
                                ));
                            } else {
                                tr.append($("<td>" + (admin.adminState == 1 ?
                                        `<div class="toggle-switch"><input type="checkbox" href="${admin.adminId}" class="toggle-switch__checkbox" checked><i class="toggle-switch__helper"></i></div>` :
                                        `<div class="toggle-switch"><input type="checkbox" href="${admin.adminId}" class="toggle-switch__checkbox"><i class="toggle-switch__helper"></i></div>`
                                ) + "</td>"));
                            }
                        } else {
                            // å½“å‰æ˜¯æ™®é€šç®¡ç†å‘˜
                            if (admin.adminId == adminSessionId || admin.adminPower == 1) {
                                tr.append($(
                                    `<td><div class="toggle-switch"><input type="checkbox" href="${admin.adminId}" class="toggle-switch__checkbox" checked disabled><i class="toggle-switch__helper"></i></div></td>`
                                ));
                            } else {
                                tr.append($("<td>" + (admin.adminState == 1 ?
                                        `<div class="toggle-switch"><input type="checkbox" href="${admin.adminId}" class="toggle-switch__checkbox" checked><i class="toggle-switch__helper"></i></div>` :
                                        `<div class="toggle-switch"><input type="checkbox" href="${admin.adminId}" class="toggle-switch__checkbox"><i class="toggle-switch__helper"></i></div>`
                                ) + "</td>"));
                            }

                        }
                        tbody.append(tr);
                    }
                    // ä¿®æ”¹å¯ç”¨ç¦ç”¨çŠ¶æ€ å› ä¸ºæ˜¯ç‚¹å‡»æŸ¥è¯¢ä¹‹åæ¸²æŸ“çš„ å¿…é¡»å†™åœ¨ $(function(){    }) é‡Œé¢
                    $('.toggle-switch__checkbox').on('click', function () {

                        const adminSessionName = JSON.parse(window.sessionStorage.getItem("loginAdmin")).adminName;
                        swal({
                            title: "ğŸ˜Š",
                            text: `ç¡®å®šè¦ä¿®æ”¹${adminSessionName}ç®¡ç†å‘˜çŠ¶æ€ä¹ˆ`,
                            icon: "warning",
                            buttons: ["å–æ¶ˆ", "ç¡®å®š"],
                            dangerMode: false,
                        }).then((willUpdate) => {
                            if (willUpdate) {
                                // è·å–checked ç‚¹å‡»ä¹‹å‰çš„çŠ¶æ€
                                const adminState = $(this).attr('checked') == "checked" ? 1 : 2;
                                // åå°ä¿®æ”¹å¯ç”¨ç¦ç”¨çŠ¶æ€
                                const data = {
                                    adminId: $(this).attr("href"),
                                    adminState: adminState == 1 ? 2 : 1
                                }
                                // å‘é€è¯·æ±‚ï¼Œä¿®æ”¹çŠ¶æ€
                                $.get(urlArray[6], data);
                                // ä¿®æ”¹htmlä¸­input çš„ checked å±æ€§
                                if (adminState == 1) {
                                    $(this).attr('checked', false);
                                } else {
                                    $(this).attr('checked', true);
                                }
                                ;
                            } else {
                                swal(`ğŸ˜Š`, `${adminSessionName}:ç®¡ç†å‘˜çŠ¶æ€æœªä¿®æ”¹!`).then(() => {
                                    selectAdminPages($("#adminPage").val());
                                })
                            }
                        });
                    })
                    // ä¸ºclassä¸ºshowAdminModel ç»‘å®šå•å‡»äº‹ä»¶
                    $(".showAdminModel").on('click', function () {
                        // è·å¾—hrefå€¼
                        const adminId = $(this).attr("href");
                        const url = urlArray[7] + adminId;
                        $.post(url, null, result => {
                            if (result.code == 0) {
                                const admin = result.resultData.admin;
                                $("#updateAdminName").val(admin.adminName);
                                $("#updateAdminPhone").val(admin.adminPhone);
                                $("#updateAdminEmail").val(admin.adminEmail);
                                $("#updateAdminId").val(admin.adminId);
                            } else {
                                swal("æŸ¥è¯¢å¤±è´¥ï¼", result.message, "error");
                            }
                        });
                        // å‘å‡ºè¯·æ±‚å¹¶è·å¾—æŒ‡å®šç¼–å·ç®¡ç†å‘˜ä¿¡æ¯
                        $("#updateAdminMessage").modal("show");
                        // æ˜¾ç¤ºæ¨¡æ€æ¡†
                        return false;

                    })
                    /*  æ ¹æ®æ€»é¡µæ•°æ˜¯å¦æ˜¾ç¤ºæ€»é¡µæ•°æŒ‰é’® */
                    //è·å¾—å†…å®¹
                    const page = result.resultData.adminsPage;
                    if (page.pages > 1) {
                        /* ä¸Šä¸€é¡µ */
                        const prePage = page.prePage;
                        if (prePage == 0) {
                            // å¦‚æœæ˜¯ç¬¬ä¸€é¡µ è®¾ç½®ä¸ºdisabled
                            pageBtnUl.append(`<li class="page-item pagination-prev disabled"><a class="page-link" href="#"></a></li>`);
                        } else {
                            pageBtnUl.append(
                                `<li class="page-item pagination-prev"><a class="page-link pageButton" href=${prePage}></a></li>`);
                        }
                        /* æ™®é€šåˆ†é¡µ */
                        const pageArray = page.navigatepageNums;
                        for (var i = 0; i < pageArray.length; i++) {
                            // é«˜äº®æ˜¾ç¤º
                            if (page.pageNum == (i + 1)) {
                                // å¦‚æœæ˜¯å½“å‰é¡µè®¾ç½®ä¸ºé«˜äº®
                                pageBtnUl.append(
                                    `<li class="page-item active"><a class="page-link pageButton" href=${pageArray[i]}>${pageArray[i]}</a></li>`
                                );
                            } else {
                                pageBtnUl.append(
                                    `<li class="page-item"><a class="page-link pageButton" href=${pageArray[i]}>${pageArray[i]}</a></li>`);
                            }
                        }
                        /* ä¸‹ä¸€é¡µ */
                        const isLastPage = page.isLastPage;
                        if (isLastPage) {
                            // å¦‚æœæ˜¯æœ€åä¸€é¡µï¼Œè®¾ç½®ä¸ºdisabled
                            pageBtnUl.append(`<li class="page-item pagination-next disabled"><a class="page-link" href="#"></a></li>`);
                        } else {
                            pageBtnUl.append(
                                `<li class="page-item pagination-next"><a class="page-link pageButton" href=${parseInt(pageNumber) + 1}></a></li>`
                            );
                        }
                        // ä¸ºclass å±æ€§ä¸º pageButton çš„åˆ†é¡µè¶…é“¾æ¥æ·»åŠ å•å‡»äº‹ä»¶
                        $(".pageButton").on('click', function () {
                            // è·å–aé“¾æ¥çš„é¡µç 
                            const temp = $(this).attr("href");
                            selectAdminPages(temp);
                            // é˜»æ­¢é»˜è®¤è¯·æ±‚
                            return false;
                        })

                    }

                } else {
                    var tr = $("<tr><td colspan='7'> æ²¡æœ‰æŸ¥è¯¢åˆ°æ»¡è¶³æ¡ä»¶çš„ç®¡ç†å‘˜ä¿¡æ¯ï¼ï¼ï¼</td></tr>");
                    tbody.append(tr);
                }
            })
        };
        // è®¾ç½®ä¿®æ”¹ç®¡ç†å‘˜æ¨¡æ€æ¡†ä¸­ä¿å­˜æŒ‰é’®çš„å•å‡»äº‹ä»¶
        $("#updateAdminMsg").click(() => {
            const data = {
                adminId: $("#updateAdminId").val(),
                adminName: $("#updateAdminName").val(),
                adminPhone: $("#updateAdminPhone").val(),
                adminEmail: $("#updateAdminEmail").val()
            };
            $.post(urlArray[6], data, (result) => {
                if (result.code == 0) {
                    $("#updateAdminMessage").modal("hide");
                    // é‡æ–°æŸ¥è¯¢å½“å‰é¡µç®¡ç†å‘˜ä¿¡æ¯
                    selectAdminPages($("#adminPage").val());
                } else {
                    swal("ä¿®æ”¹å¤±è´¥ï¼", result.message, "error");
                }
            })
        })

    });
</script>
<!-- å¯¹äºHTMLå…ƒç´ æœ¬èº«å°±å¸¦æœ‰çš„å›ºæœ‰å±æ€§ï¼Œåœ¨å¤„ç†æ—¶ï¼Œä½¿ç”¨propæ–¹æ³•
     å¯¹äºHTMLå…ƒç´ æˆ‘ä»¬è‡ªå·±è‡ªå®šä¹‰çš„DOMå±æ€§ï¼Œåœ¨å¤„ç†æ—¶ï¼Œä½¿ç”¨attræ–¹æ³•ã€‚-->
</body>
</html>
